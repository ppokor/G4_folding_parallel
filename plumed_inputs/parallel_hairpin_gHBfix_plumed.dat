# vim:ft=plumed
LOAD FILE=./GHBFIX.cpp

MOLINFO STRUCTURE=../reference_structures/GGGTTAGGG/parallel_propeller_aaa-aaa.pdb
WHOLEMOLECULES ENTITY0=1-293	

# gHBfix SECTION
#! GroupA and GroupB are all relevant donors and acceptors. D_0, D_MAX and C have to be defined according to the gHBfix switching function - default values printed (Kuehrova, Mlynsky et al., JCTC 2019). Each relevant type of donor and acceptor are labeled with an integer (gHBfix_typesTable.dat) and eta/scaling parameters are specified (gHBfix_scalingParameters.dat).

group_1: GHBFIX PAIR GROUPA=19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,19,19,22,22,23,23,19,19,22,22,23,23,19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,52,52,55,55,56,56,52,52,55,55,56,56,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,85,85,88,88,89,89,85,85,88,88,89,89,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,121,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,153,181,181,181,182,182,182,181,181,181,182,182,182,181,181,181,182,182,182,181,181,182,182,181,181,182,182,181,181,181,182,182,182,181,181,181,182,182,182,181,181,181,182,182,182,214,214,214,217,217,217,218,218,218,214,214,214,217,217,217,218,218,218,214,214,214,217,217,217,218,218,218,214,214,217,217,218,218,214,214,217,217,218,218,214,214,214,217,217,217,218,218,218,214,214,214,217,217,217,218,218,218,214,214,214,217,217,217,218,218,218,247,247,247,250,250,250,251,251,251,247,247,247,250,250,250,251,251,251,247,247,247,250,250,250,251,251,251,247,247,250,250,251,251,247,247,250,250,251,251,247,247,247,250,250,250,251,251,251,247,247,247,250,250,250,251,251,251,247,247,247,250,250,250,251,251,251,280,280,280,283,283,283,284,284,284,280,280,280,283,283,283,284,284,284,280,280,280,283,283,283,284,284,284,280,280,283,283,284,284,280,280,283,283,284,284,280,280,280,283,283,283,284,284,284,280,280,280,283,283,283,284,284,284,280,280,280,283,283,283,284,284,284 GROUPB=50,47,57,50,47,57,50,47,57,83,80,90,83,80,90,83,80,90,119,123,119,123,119,123,151,155,151,155,151,155,177,183,186,177,183,186,177,183,186,212,209,219,212,209,219,212,209,219,245,242,252,245,242,252,245,242,252,278,275,285,278,275,285,278,275,285,17,14,24,17,14,24,17,14,24,83,80,90,83,80,90,83,80,90,119,123,119,123,119,123,151,155,151,155,151,155,177,183,186,177,183,186,177,183,186,212,209,219,212,209,219,212,209,219,245,242,252,245,242,252,245,242,252,278,275,285,278,275,285,278,275,285,17,14,24,17,14,24,17,14,24,50,47,57,50,47,57,50,47,57,119,123,119,123,119,123,151,155,151,155,151,155,177,183,186,177,183,186,177,183,186,212,209,219,212,209,219,212,209,219,245,242,252,245,242,252,245,242,252,278,275,285,278,275,285,278,275,285,17,14,24,50,47,57,83,80,90,151,155,177,183,186,212,209,219,245,242,252,278,275,285,17,14,24,50,47,57,83,80,90,119,123,177,183,186,212,209,219,245,242,252,278,275,285,17,14,24,17,14,24,50,47,57,50,47,57,83,80,90,83,80,90,119,123,119,123,151,155,151,155,212,209,219,212,209,219,245,242,252,245,242,252,278,275,285,278,275,285,17,14,24,17,14,24,17,14,24,50,47,57,50,47,57,50,47,57,83,80,90,83,80,90,83,80,90,119,123,119,123,119,123,151,155,151,155,151,155,177,183,186,177,183,186,177,183,186,245,242,252,245,242,252,245,242,252,278,275,285,278,275,285,278,275,285,17,14,24,17,14,24,17,14,24,50,47,57,50,47,57,50,47,57,83,80,90,83,80,90,83,80,90,119,123,119,123,119,123,151,155,151,155,151,155,177,183,186,177,183,186,177,183,186,212,209,219,212,209,219,212,209,219,278,275,285,278,275,285,278,275,285,17,14,24,17,14,24,17,14,24,50,47,57,50,47,57,50,47,57,83,80,90,83,80,90,83,80,90,119,123,119,123,119,123,151,155,151,155,151,155,177,183,186,177,183,186,177,183,186,212,209,219,212,209,219,212,209,219,245,242,252,245,242,252,245,242,252 D_0=0.2 D_MAX=0.3 C=0.8 TYPES=./gHBfix_typesTable_hairpin.dat PARAMS=./gHBfix_scalingParameters_hairpin.dat

# scaling of gHBfix in replicas. reference replica has 2kcal/mol gHBfix. coefs=lambdas (scalingTable has 1.00)
tot_1: COMBINE ARG=group_1 COEFFICIENTS=@replicas:{2.0000000,1.9092000,1.8225220,1.7397800,1.6607940,1.5853940,1.5134160,1.4447080,1.3791180,1.3165060,1.2567360,1.1996800} PERIODIC=NO

BIASVALUE ARG=tot_1 LABEL=all_group_1

# biasing eRMSD with augmented cutoff:
DISTfull: ERMSD ATOMS=@lcs-1,@lcs-2,@lcs-3,@lcs-7,@lcs-8,@lcs-9 REFERENCE=../reference_structures/GGGTTAGGG/parallel_propeller_aaa-aaa.pdb CUTOFF=3.2
DISTg5end: ERMSD ATOMS=@lcs-1,@lcs-2,@lcs-3 REFERENCE=../reference_structures/GGGTTAGGG/parallel_propeller_aaa-aaa.pdb CUTOFF=3.2
DISTg3end: ERMSD ATOMS=@lcs-7,@lcs-8,@lcs-9 REFERENCE=../reference_structures/GGGTTAGGG/parallel_propeller_aaa-aaa.pdb CUTOFF=3.2

COMBINE  LABEL=DD  ARG=DISTfull,DISTg5end,DISTg3end COEFFICIENTS=6,-3,-3 POWERS=2,2,2 PERIODIC=NO
COMBINE LABEL=interD  ARG=DD POWERS=0.5 PERIODIC=NO COEFFICIENTS=0.40824829 #COEF=sqrt(1/6)

# eRMSD with standard cutoff (2.4), used for monitoring only:
DIST1: ERMSD ATOMS=@lcs-1,@lcs-2,@lcs-3,@lcs-7,@lcs-8,@lcs-9 REFERENCE=../reference_structures/GGGTTAGGG/parallel_propeller_aaa-aaa.pdb

# metadynamics
metad: METAD ARG=interD PACE=250 TAU=70 SIGMA=0.1 FILE=HILLS TEMP=298 BIASFACTOR=15 GRID_MIN=0 GRID_MAX=4.0 GRID_SPACING=0.02

# print 
PRINT ARG=tot_1,all_group_1.bias STRIDE=250 FILE=check_ghbfix.dat
PRINT ARG=interD,DIST1,metad.bias FILE=COLVAR STRIDE=250


