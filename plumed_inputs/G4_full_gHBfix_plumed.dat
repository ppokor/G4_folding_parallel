# vim:ft=plumed

# uncomment the following LOAD line if using older version of PLUMED:
# LOAD FILE=./GHBFIX.cpp


MOLINFO STRUCTURE=../reference_structures/G4/G4_full.pdb
WHOLEMOLECULES ENTITY0=1-491	

# gHBfix SECTION
#! GroupA and GroupB are all relevant donors and acceptors. D_0, D_MAX and C have to be defined according to the gHBfix switching function - default values printed (Kuehrova, Mlynsky et al., JCTC 2019). Each relevant type of donor and acceptor are labeled with an integer (typesTable.dat) and eta/scaling parameters are specified (scalingParameters.dat).
group_1: GHBFIX PAIR GROUPA=19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,19,19,19,22,22,22,23,23,23,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,52,52,52,55,55,55,56,56,56,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,85,85,85,88,88,88,89,89,89,117,117,117,118,118,118,117,117,117,118,118,118,117,117,117,118,118,118,117,117,117,118,118,118,117,117,117,118,118,118,117,117,117,118,118,118,117,117,117,118,118,118,117,117,117,118,118,118,117,117,117,118,118,118,117,117,117,118,118,118,117,117,117,118,118,118,117,117,117,118,118,118,117,117,117,118,118,118,117,117,117,118,118,118,150,150,150,153,153,153,154,154,154,150,150,150,153,153,153,154,154,154,150,150,150,153,153,153,154,154,154,150,150,150,153,153,153,154,154,154,150,150,150,153,153,153,154,154,154,150,150,150,153,153,153,154,154,154,150,150,150,153,153,153,154,154,154,150,150,150,153,153,153,154,154,154,150,150,150,153,153,153,154,154,154,150,150,150,153,153,153,154,154,154,150,150,150,153,153,153,154,154,154,150,150,150,153,153,153,154,154,154,150,150,150,153,153,153,154,154,154,150,150,150,153,153,153,154,154,154,183,183,183,186,186,186,187,187,187,183,183,183,186,186,186,187,187,187,183,183,183,186,186,186,187,187,187,183,183,183,186,186,186,187,187,187,183,183,183,186,186,186,187,187,187,183,183,183,186,186,186,187,187,187,183,183,183,186,186,186,187,187,187,183,183,183,186,186,186,187,187,187,183,183,183,186,186,186,187,187,187,183,183,183,186,186,186,187,187,187,183,183,183,186,186,186,187,187,187,183,183,183,186,186,186,187,187,187,183,183,183,186,186,186,187,187,187,183,183,183,186,186,186,187,187,187,216,216,216,219,219,219,220,220,220,216,216,216,219,219,219,220,220,220,216,216,216,219,219,219,220,220,220,216,216,216,219,219,219,220,220,220,216,216,216,219,219,219,220,220,220,216,216,216,219,219,219,220,220,220,216,216,216,219,219,219,220,220,220,216,216,216,219,219,219,220,220,220,216,216,216,219,219,219,220,220,220,216,216,216,219,219,219,220,220,220,216,216,216,219,219,219,220,220,220,216,216,216,219,219,219,220,220,220,216,216,216,219,219,219,220,220,220,216,216,216,219,219,219,220,220,220,248,248,248,249,249,249,248,248,248,249,249,249,248,248,248,249,249,249,248,248,248,249,249,249,248,248,248,249,249,249,248,248,248,249,249,249,248,248,248,249,249,249,248,248,248,249,249,249,248,248,248,249,249,249,248,248,248,249,249,249,248,248,248,249,249,249,248,248,248,249,249,249,248,248,248,249,249,249,248,248,248,249,249,249,281,281,281,284,284,284,285,285,285,281,281,281,284,284,284,285,285,285,281,281,281,284,284,284,285,285,285,281,281,281,284,284,284,285,285,285,281,281,281,284,284,284,285,285,285,281,281,281,284,284,284,285,285,285,281,281,281,284,284,284,285,285,285,281,281,281,284,284,284,285,285,285,281,281,281,284,284,284,285,285,285,281,281,281,284,284,284,285,285,285,281,281,281,284,284,284,285,285,285,281,281,281,284,284,284,285,285,285,281,281,281,284,284,284,285,285,285,281,281,281,284,284,284,285,285,285,314,314,314,317,317,317,318,318,318,314,314,314,317,317,317,318,318,318,314,314,314,317,317,317,318,318,318,314,314,314,317,317,317,318,318,318,314,314,314,317,317,317,318,318,318,314,314,314,317,317,317,318,318,318,314,314,314,317,317,317,318,318,318,314,314,314,317,317,317,318,318,318,314,314,314,317,317,317,318,318,318,314,314,314,317,317,317,318,318,318,314,314,314,317,317,317,318,318,318,314,314,314,317,317,317,318,318,318,314,314,314,317,317,317,318,318,318,314,314,314,317,317,317,318,318,318,347,347,347,350,350,350,351,351,351,347,347,347,350,350,350,351,351,351,347,347,347,350,350,350,351,351,351,347,347,347,350,350,350,351,351,351,347,347,347,350,350,350,351,351,351,347,347,347,350,350,350,351,351,351,347,347,347,350,350,350,351,351,351,347,347,347,350,350,350,351,351,351,347,347,347,350,350,350,351,351,351,347,347,347,350,350,350,351,351,351,347,347,347,350,350,350,351,351,351,347,347,347,350,350,350,351,351,351,347,347,347,350,350,350,351,351,351,347,347,347,350,350,350,351,351,351,379,379,379,380,380,380,379,379,379,380,380,380,379,379,379,380,380,380,379,379,379,380,380,380,379,379,379,380,380,380,379,379,379,380,380,380,379,379,379,380,380,380,379,379,379,380,380,380,379,379,379,380,380,380,379,379,379,380,380,380,379,379,379,380,380,380,379,379,379,380,380,380,379,379,379,380,380,380,379,379,379,380,380,380,412,412,412,415,415,415,416,416,416,412,412,412,415,415,415,416,416,416,412,412,412,415,415,415,416,416,416,412,412,412,415,415,415,416,416,416,412,412,412,415,415,415,416,416,416,412,412,412,415,415,415,416,416,416,412,412,412,415,415,415,416,416,416,412,412,412,415,415,415,416,416,416,412,412,412,415,415,415,416,416,416,412,412,412,415,415,415,416,416,416,412,412,412,415,415,415,416,416,416,412,412,412,415,415,415,416,416,416,412,412,412,415,415,415,416,416,416,412,412,412,415,415,415,416,416,416,445,445,445,448,448,448,449,449,449,445,445,445,448,448,448,449,449,449,445,445,445,448,448,448,449,449,449,445,445,445,448,448,448,449,449,449,445,445,445,448,448,448,449,449,449,445,445,445,448,448,448,449,449,449,445,445,445,448,448,448,449,449,449,445,445,445,448,448,448,449,449,449,445,445,445,448,448,448,449,449,449,445,445,445,448,448,448,449,449,449,445,445,445,448,448,448,449,449,449,445,445,445,448,448,448,449,449,449,445,445,445,448,448,448,449,449,449,445,445,445,448,448,448,449,449,449,478,478,478,481,481,481,482,482,482,478,478,478,481,481,481,482,482,482,478,478,478,481,481,481,482,482,482,478,478,478,481,481,481,482,482,482,478,478,478,481,481,481,482,482,482,478,478,478,481,481,481,482,482,482,478,478,478,481,481,481,482,482,482,478,478,478,481,481,481,482,482,482,478,478,478,481,481,481,482,482,482,478,478,478,481,481,481,482,482,482,478,478,478,481,481,481,482,482,482,478,478,478,481,481,481,482,482,482,478,478,478,481,481,481,482,482,482,478,478,478,481,481,481,482,482,482 GROUPB=50,47,57,50,47,57,50,47,57,83,80,90,83,80,90,83,80,90,113,119,122,113,119,122,113,119,122,148,145,155,148,145,155,148,145,155,181,178,188,181,178,188,181,178,188,214,211,221,214,211,221,214,211,221,244,250,253,244,250,253,244,250,253,279,276,286,279,276,286,279,276,286,312,309,319,312,309,319,312,309,319,345,342,352,345,342,352,345,342,352,375,381,384,375,381,384,375,381,384,410,407,417,410,407,417,410,407,417,443,440,450,443,440,450,443,440,450,476,473,483,476,473,483,476,473,483,17,14,24,17,14,24,17,14,24,83,80,90,83,80,90,83,80,90,113,119,122,113,119,122,113,119,122,148,145,155,148,145,155,148,145,155,181,178,188,181,178,188,181,178,188,214,211,221,214,211,221,214,211,221,244,250,253,244,250,253,244,250,253,279,276,286,279,276,286,279,276,286,312,309,319,312,309,319,312,309,319,345,342,352,345,342,352,345,342,352,375,381,384,375,381,384,375,381,384,410,407,417,410,407,417,410,407,417,443,440,450,443,440,450,443,440,450,476,473,483,476,473,483,476,473,483,17,14,24,17,14,24,17,14,24,50,47,57,50,47,57,50,47,57,113,119,122,113,119,122,113,119,122,148,145,155,148,145,155,148,145,155,181,178,188,181,178,188,181,178,188,214,211,221,214,211,221,214,211,221,244,250,253,244,250,253,244,250,253,279,276,286,279,276,286,279,276,286,312,309,319,312,309,319,312,309,319,345,342,352,345,342,352,345,342,352,375,381,384,375,381,384,375,381,384,410,407,417,410,407,417,410,407,417,443,440,450,443,440,450,443,440,450,476,473,483,476,473,483,476,473,483,17,14,24,17,14,24,50,47,57,50,47,57,83,80,90,83,80,90,148,145,155,148,145,155,181,178,188,181,178,188,214,211,221,214,211,221,244,250,253,244,250,253,279,276,286,279,276,286,312,309,319,312,309,319,345,342,352,345,342,352,375,381,384,375,381,384,410,407,417,410,407,417,443,440,450,443,440,450,476,473,483,476,473,483,17,14,24,17,14,24,17,14,24,50,47,57,50,47,57,50,47,57,83,80,90,83,80,90,83,80,90,113,119,122,113,119,122,113,119,122,181,178,188,181,178,188,181,178,188,214,211,221,214,211,221,214,211,221,244,250,253,244,250,253,244,250,253,279,276,286,279,276,286,279,276,286,312,309,319,312,309,319,312,309,319,345,342,352,345,342,352,345,342,352,375,381,384,375,381,384,375,381,384,410,407,417,410,407,417,410,407,417,443,440,450,443,440,450,443,440,450,476,473,483,476,473,483,476,473,483,17,14,24,17,14,24,17,14,24,50,47,57,50,47,57,50,47,57,83,80,90,83,80,90,83,80,90,113,119,122,113,119,122,113,119,122,148,145,155,148,145,155,148,145,155,214,211,221,214,211,221,214,211,221,244,250,253,244,250,253,244,250,253,279,276,286,279,276,286,279,276,286,312,309,319,312,309,319,312,309,319,345,342,352,345,342,352,345,342,352,375,381,384,375,381,384,375,381,384,410,407,417,410,407,417,410,407,417,443,440,450,443,440,450,443,440,450,476,473,483,476,473,483,476,473,483,17,14,24,17,14,24,17,14,24,50,47,57,50,47,57,50,47,57,83,80,90,83,80,90,83,80,90,113,119,122,113,119,122,113,119,122,148,145,155,148,145,155,148,145,155,181,178,188,181,178,188,181,178,188,244,250,253,244,250,253,244,250,253,279,276,286,279,276,286,279,276,286,312,309,319,312,309,319,312,309,319,345,342,352,345,342,352,345,342,352,375,381,384,375,381,384,375,381,384,410,407,417,410,407,417,410,407,417,443,440,450,443,440,450,443,440,450,476,473,483,476,473,483,476,473,483,17,14,24,17,14,24,50,47,57,50,47,57,83,80,90,83,80,90,113,119,122,113,119,122,148,145,155,148,145,155,181,178,188,181,178,188,214,211,221,214,211,221,279,276,286,279,276,286,312,309,319,312,309,319,345,342,352,345,342,352,375,381,384,375,381,384,410,407,417,410,407,417,443,440,450,443,440,450,476,473,483,476,473,483,17,14,24,17,14,24,17,14,24,50,47,57,50,47,57,50,47,57,83,80,90,83,80,90,83,80,90,113,119,122,113,119,122,113,119,122,148,145,155,148,145,155,148,145,155,181,178,188,181,178,188,181,178,188,214,211,221,214,211,221,214,211,221,244,250,253,244,250,253,244,250,253,312,309,319,312,309,319,312,309,319,345,342,352,345,342,352,345,342,352,375,381,384,375,381,384,375,381,384,410,407,417,410,407,417,410,407,417,443,440,450,443,440,450,443,440,450,476,473,483,476,473,483,476,473,483,17,14,24,17,14,24,17,14,24,50,47,57,50,47,57,50,47,57,83,80,90,83,80,90,83,80,90,113,119,122,113,119,122,113,119,122,148,145,155,148,145,155,148,145,155,181,178,188,181,178,188,181,178,188,214,211,221,214,211,221,214,211,221,244,250,253,244,250,253,244,250,253,279,276,286,279,276,286,279,276,286,345,342,352,345,342,352,345,342,352,375,381,384,375,381,384,375,381,384,410,407,417,410,407,417,410,407,417,443,440,450,443,440,450,443,440,450,476,473,483,476,473,483,476,473,483,17,14,24,17,14,24,17,14,24,50,47,57,50,47,57,50,47,57,83,80,90,83,80,90,83,80,90,113,119,122,113,119,122,113,119,122,148,145,155,148,145,155,148,145,155,181,178,188,181,178,188,181,178,188,214,211,221,214,211,221,214,211,221,244,250,253,244,250,253,244,250,253,279,276,286,279,276,286,279,276,286,312,309,319,312,309,319,312,309,319,375,381,384,375,381,384,375,381,384,410,407,417,410,407,417,410,407,417,443,440,450,443,440,450,443,440,450,476,473,483,476,473,483,476,473,483,17,14,24,17,14,24,50,47,57,50,47,57,83,80,90,83,80,90,113,119,122,113,119,122,148,145,155,148,145,155,181,178,188,181,178,188,214,211,221,214,211,221,244,250,253,244,250,253,279,276,286,279,276,286,312,309,319,312,309,319,345,342,352,345,342,352,410,407,417,410,407,417,443,440,450,443,440,450,476,473,483,476,473,483,17,14,24,17,14,24,17,14,24,50,47,57,50,47,57,50,47,57,83,80,90,83,80,90,83,80,90,113,119,122,113,119,122,113,119,122,148,145,155,148,145,155,148,145,155,181,178,188,181,178,188,181,178,188,214,211,221,214,211,221,214,211,221,244,250,253,244,250,253,244,250,253,279,276,286,279,276,286,279,276,286,312,309,319,312,309,319,312,309,319,345,342,352,345,342,352,345,342,352,375,381,384,375,381,384,375,381,384,443,440,450,443,440,450,443,440,450,476,473,483,476,473,483,476,473,483,17,14,24,17,14,24,17,14,24,50,47,57,50,47,57,50,47,57,83,80,90,83,80,90,83,80,90,113,119,122,113,119,122,113,119,122,148,145,155,148,145,155,148,145,155,181,178,188,181,178,188,181,178,188,214,211,221,214,211,221,214,211,221,244,250,253,244,250,253,244,250,253,279,276,286,279,276,286,279,276,286,312,309,319,312,309,319,312,309,319,345,342,352,345,342,352,345,342,352,375,381,384,375,381,384,375,381,384,410,407,417,410,407,417,410,407,417,476,473,483,476,473,483,476,473,483,17,14,24,17,14,24,17,14,24,50,47,57,50,47,57,50,47,57,83,80,90,83,80,90,83,80,90,113,119,122,113,119,122,113,119,122,148,145,155,148,145,155,148,145,155,181,178,188,181,178,188,181,178,188,214,211,221,214,211,221,214,211,221,244,250,253,244,250,253,244,250,253,279,276,286,279,276,286,279,276,286,312,309,319,312,309,319,312,309,319,345,342,352,345,342,352,345,342,352,375,381,384,375,381,384,375,381,384,410,407,417,410,407,417,410,407,417,443,440,450,443,440,450,443,440,450 D_0=0.2 D_MAX=0.3 C=0.8 TYPES=gHBfix_typesTable_g4.dat PARAMS=gHBfix_scalingParameters_g4.dat


# scaling of gHBfix in replicas. reference replica has 2kcal/mol gHBfix. coefs=lambdas (scalingTable has 2.00)
tot_1: COMBINE ARG=group_1 COEFFICIENTS=@replicas:{1.045400,1.022700,1.000000,0.976270,0.954600,0.931947,0.911261,0.869890,0.830397,0.792697,0.756708,0.722354,0.689559,0.658253,0.628368,0.599840} PERIODIC=NO

BIASVALUE ARG=tot_1 LABEL=all_group_1

# biasing eRMSD with augmented cutoff:
DISTfull: ERMSD ATOMS=@lcs-1,@lcs-2,@lcs-3,@lcs-5,@lcs-6,@lcs-7,@lcs-9,@lcs-10,@lcs-11,@lcs-13,@lcs-14,@lcs-15 REFERENCE=../reference_structures/G4/G4_full.pdb CUTOFF=3.2
DISTpart1: ERMSD ATOMS=@lcs-1,@lcs-2,@lcs-3 REFERENCE=../reference_structures/G4/G4_full.pdb CUTOFF=3.2
DISTpart2: ERMSD ATOMS=@lcs-5,@lcs-6,@lcs-7 REFERENCE=../reference_structures/G4/G4_full.pdb CUTOFF=3.2
DISTpart3: ERMSD ATOMS=@lcs-9,@lcs-10,@lcs-11 REFERENCE=../reference_structures/G4/G4_full.pdb CUTOFF=3.2
DISTpart4: ERMSD ATOMS=@lcs-13,@lcs-14,@lcs-15 REFERENCE=../reference_structures/G4/G4_full.pdb CUTOFF=3.2


COMBINE  LABEL=DD  ARG=DISTfull,DISTpart1,DISTpart2,DISTpart3,DISTpart4 COEFFICIENTS=12,-3,-3,-3,-3 POWERS=2,2,2,2,2 PERIODIC=NO
COMBINE LABEL=interD  ARG=DD POWERS=0.5 PERIODIC=NO COEFFICIENTS=0.288675135  #COEF=sqrt(1/12

# eRMSD with standard cutoff (2.4), used for monitoring only:
DIST1: ERMSD ATOMS=@lcs-1,@lcs-2,@lcs-3,@lcs-5,@lcs-6,@lcs-7,@lcs-9,@lcs-10,@lcs-11,@lcs-13,@lcs-14,@lcs-15 REFERENCE=../reference_structures/G4/G4_full.pdb

# metadynamics
metad: METAD ARG=interD PACE=250 TAU=70 SIGMA=0.1 FILE=HILLS TEMP=298 BIASFACTOR=15 GRID_MIN=0 GRID_MAX=5.0 GRID_SPACING=0.02

# print
PRINT ARG=interD,DIST1,metad.bias FILE=COLVAR STRIDE=250
PRINT ARG=all_group_1.bias STRIDE=250 FILE=check_ghbfix.dat


